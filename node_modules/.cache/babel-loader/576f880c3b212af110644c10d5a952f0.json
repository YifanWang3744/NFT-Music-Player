{"ast":null,"code":"var _jsxFileName = \"/Users/cengwenxin/Desktop/6883project/src/frontend/components/Search.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useRef } from 'react';\nimport { ethers } from \"ethers\";\nimport Identicon from 'identicon.js';\nimport { Row, Col, Card, Button, InputGroup, Form } from 'react-bootstrap';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Search(_ref) {\n  _s();\n\n  let {\n    contract,\n    searchedSong\n  } = _ref;\n  const audioRefs = useRef([]);\n  const [isPlaying, setIsPlaying] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [selected, setSelected] = useState(0);\n  const [previous, setPrevious] = useState(null);\n  const [marketItems, setMarketItems] = useState(null);\n  const [selectedItems, setSelectedItems] = useState(null);\n\n  const loadMarketplaceItems = async () => {\n    // Get all unsold items/tokens\n    const results = await contract.getAllUnsoldTokens();\n    const marketItems = await Promise.all(results.map(async i => {\n      if (i.tokenId != 3) {\n        // get uri url from contract\n        const uri = await contract.tokenURI(i.tokenId); // use uri to fetch the nft metadata stored on ipfs \n\n        const response = await fetch(uri + \".json\");\n        const metadata = await response.json();\n        const identicon = `data:image/png;base64,${new Identicon(metadata.name + metadata.price, 330).toString()}`; // define item object\n\n        let item = {\n          price: i.price,\n          itemId: i.tokenId,\n          name: metadata.name,\n          audio: metadata.audio,\n          identicon\n        };\n        return item;\n      } else {\n        // get uri url from contract\n        const uri = await contract.tokenURI(i.tokenId); // use uri to fetch the nft metadata stored on ipfs \n\n        const response = await fetch(uri + \".json\");\n        const metadata = await response.json();\n        const identicon = `data:image/png;base64,${new Identicon(metadata.name + 'cold' + metadata.price, 330).toString()}`; // define item object\n\n        let item = {\n          price: i.price,\n          itemId: i.tokenId,\n          name: metadata.name,\n          audio: metadata.audio,\n          identicon\n        };\n        return item;\n      }\n    }));\n    setMarketItems(marketItems);\n    const selectedItems = marketItems.filter(i => i.name.toLowerCase().includes(searchedSong));\n    setSelectedItems(selectedItems);\n    setLoading(false);\n  };\n\n  const buyMarketItem = async item => {\n    await (await contract.buyToken(item.itemId, {\n      value: item.price\n    })).wait();\n    loadMarketplaceItems();\n  };\n\n  useEffect(() => {\n    if (isPlaying) {\n      audioRefs.current[selected].play();\n      if (selected !== previous) audioRefs.current[previous].pause();\n    } else if (isPlaying !== null) {\n      audioRefs.current[selected].pause();\n    }\n  });\n  useEffect(() => {\n    !selectedItems && loadMarketplaceItems();\n  });\n  if (loading) return /*#__PURE__*/_jsxDEV(\"main\", {\n    style: {\n      padding: \"1rem 0\"\n    },\n    children: /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex justify-center\",\n    children: selectedItems.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-5 container\",\n      children: /*#__PURE__*/_jsxDEV(Row, {\n        xs: 1,\n        md: 2,\n        lg: 4,\n        className: \"g-4 py-5\",\n        children: selectedItems.map((item, idx) => /*#__PURE__*/_jsxDEV(Col, {\n          className: \"overflow-hidden\",\n          children: [/*#__PURE__*/_jsxDEV(\"audio\", {\n            src: item.audio,\n            ref: el => audioRefs.current[idx] = el\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Card, {\n            children: [/*#__PURE__*/_jsxDEV(Card.Img, {\n              variant: \"top\",\n              src: item.identicon\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Card.Body, {\n              color: \"secondary\",\n              children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n                children: item.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 95,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-grid px-4\",\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"secondary\",\n                  onClick: () => {\n                    setPrevious(selected);\n                    setSelected(idx);\n                    if (!isPlaying || idx === selected) setIsPlaying(!isPlaying);\n                  },\n                  children: isPlaying && selected === idx ? /*#__PURE__*/_jsxDEV(\"svg\", {\n                    xmlns: \"http://www.w3.org/2000/svg\",\n                    width: \"23\",\n                    height: \"23\",\n                    fill: \"currentColor\",\n                    className: \"bi bi-pause\",\n                    viewBox: \"0 0 16 16\",\n                    children: /*#__PURE__*/_jsxDEV(\"path\", {\n                      d: \"M6 3.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5zm4 0a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5z\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 104,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 103,\n                    columnNumber: 27\n                  }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n                    xmlns: \"http://www.w3.org/2000/svg\",\n                    width: \"23\",\n                    height: \"23\",\n                    fill: \"currentColor\",\n                    className: \"bi bi-play\",\n                    viewBox: \"0 0 16 16\",\n                    children: /*#__PURE__*/_jsxDEV(\"path\", {\n                      d: \"M10.804 8 5 4.633v6.734L10.804 8zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692z\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 108,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 107,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 97,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 96,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Card.Footer, {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-grid my-1\",\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  onClick: () => buyMarketItem(item),\n                  variant: \"primary\",\n                  size: \"lg\",\n                  children: `Buy for ${ethers.utils.formatEther(item.price)} ETH`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 116,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 115,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 17\n          }, this)]\n        }, idx, true, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"main\", {\n      style: {\n        padding: \"1rem 0\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Sorry! We cannot find what you want\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 11\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Search, \"dgHMcS7c7o9XHJgpKJaQdEoacs0=\");\n\n_c = Search;\n\nvar _c;\n\n$RefreshReg$(_c, \"Search\");","map":{"version":3,"sources":["/Users/cengwenxin/Desktop/6883project/src/frontend/components/Search.js"],"names":["useState","useEffect","useRef","ethers","Identicon","Row","Col","Card","Button","InputGroup","Form","Search","contract","searchedSong","audioRefs","isPlaying","setIsPlaying","loading","setLoading","selected","setSelected","previous","setPrevious","marketItems","setMarketItems","selectedItems","setSelectedItems","loadMarketplaceItems","results","getAllUnsoldTokens","Promise","all","map","i","tokenId","uri","tokenURI","response","fetch","metadata","json","identicon","name","price","toString","item","itemId","audio","filter","toLowerCase","includes","buyMarketItem","buyToken","value","wait","current","play","pause","padding","length","idx","el","utils","formatEther"],"mappings":"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","sourcesContent":["import { useState, useEffect, useRef } from 'react'\nimport { ethers } from \"ethers\"\nimport Identicon from 'identicon.js';\nimport { Row, Col, Card, Button, InputGroup, Form } from 'react-bootstrap'\n\nexport default function Search({ contract,searchedSong }) {\n  const audioRefs = useRef([]);\n  const [isPlaying, setIsPlaying] = useState(null)\n  const [loading, setLoading] = useState(true)\n  const [selected, setSelected] = useState(0)\n  const [previous, setPrevious] = useState(null)\n  const [marketItems, setMarketItems] = useState(null)\n  const [selectedItems, setSelectedItems] = useState(null)\n  const loadMarketplaceItems = async () => {\n    // Get all unsold items/tokens\n    const results = await contract.getAllUnsoldTokens()\n    const marketItems = await Promise.all(results.map(async i => {\n      if (i.tokenId != 3){\n      // get uri url from contract\n      const uri = await contract.tokenURI(i.tokenId)\n      // use uri to fetch the nft metadata stored on ipfs \n      const response = await fetch(uri + \".json\")\n      const metadata = await response.json()\n      const identicon = `data:image/png;base64,${new Identicon(metadata.name + metadata.price, 330).toString()}`\n      // define item object\n      let item = {\n        price: i.price,\n        itemId: i.tokenId,\n        name: metadata.name,\n        audio: metadata.audio,\n        identicon\n      }\n      return item\n      }\n      else{\n      // get uri url from contract\n      const uri = await contract.tokenURI(i.tokenId)\n      // use uri to fetch the nft metadata stored on ipfs \n      const response = await fetch(uri + \".json\")\n      const metadata = await response.json()\n      const identicon = `data:image/png;base64,${new Identicon(metadata.name + 'cold' + metadata.price, 330).toString()}`\n      // define item object\n      let item = {\n        price: i.price,\n        itemId: i.tokenId,\n        name: metadata.name,\n        audio: metadata.audio,\n        identicon\n      }\n      return item\n      }\n      \n    }))\n      setMarketItems(marketItems)\n      const selectedItems = marketItems.filter(i => (i.name.toLowerCase().includes(searchedSong)))\n      setSelectedItems(selectedItems)\n      setLoading(false)\n  }\n\n  const buyMarketItem = async (item) => {\n    await (await contract.buyToken(item.itemId, { value: item.price })).wait()\n    loadMarketplaceItems()\n  }\n  \n  useEffect(() => {\n    if (isPlaying) {\n      audioRefs.current[selected].play()\n      if (selected !== previous) audioRefs.current[previous].pause()\n    } else if (isPlaying !== null) {\n      audioRefs.current[selected].pause()\n    }\n\n  })\n  useEffect(() => {\n    !selectedItems && loadMarketplaceItems()\n  })\n\n  if (loading) return (\n    <main style={{ padding: \"1rem 0\" }}>\n      <h2>Loading...</h2>\n    </main>\n  )\n\n  return (\n    <div className=\"flex justify-center\">\n      {selectedItems.length > 0 ?\n        <div className=\"px-5 container\">\n          <Row xs={1} md={2} lg={4} className=\"g-4 py-5\">\n            {selectedItems.map((item, idx) => (\n              <Col key={idx} className=\"overflow-hidden\">\n                <audio src={item.audio} key={idx} ref={el => audioRefs.current[idx] = el}></audio>\n                <Card>\n                  <Card.Img variant=\"top\" src={item.identicon} />\n                  <Card.Body color=\"secondary\">\n                    <Card.Title>{item.name}</Card.Title>\n                    <div className=\"d-grid px-4\">\n                      <Button variant=\"secondary\" onClick={() => {\n                        setPrevious(selected)\n                        setSelected(idx)\n                        if (!isPlaying || idx === selected) setIsPlaying(!isPlaying)\n                      }}>\n                        {isPlaying && selected === idx ? (\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"23\" height=\"23\" fill=\"currentColor\" className=\"bi bi-pause\" viewBox=\"0 0 16 16\">\n                            <path d=\"M6 3.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5zm4 0a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5z\" />\n                          </svg>\n                        ) : (\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"23\" height=\"23\" fill=\"currentColor\" className=\"bi bi-play\" viewBox=\"0 0 16 16\">\n                            <path d=\"M10.804 8 5 4.633v6.734L10.804 8zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692z\" />\n                          </svg>\n                        )}\n                      </Button>\n                    </div>\n                  </Card.Body>\n                  <Card.Footer>\n                  <div className='d-grid my-1'>\n                    <Button onClick={() => buyMarketItem(item)} variant=\"primary\" size=\"lg\">\n                      {`Buy for ${ethers.utils.formatEther(item.price)} ETH`}\n                    </Button>\n                  </div>\n                </Card.Footer>\n                </Card>\n              </Col>\n            ))}\n          </Row>\n        </div>\n        : (\n          <main style={{ padding: \"1rem 0\" }}>\n            <h2>Sorry! We cannot find what you want</h2>\n          </main>\n        )}\n    </div>\n  );\n}"]},"metadata":{},"sourceType":"module"}