{"ast":null,"code":"var _jsxFileName = \"/Users/cengwenxin/Desktop/6883project/src/frontend/components/Home.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useRef } from 'react';\nimport { ethers } from \"ethers\";\nimport Identicon from 'identicon.js';\nimport { Card, Button, ButtonGroup } from 'react-bootstrap';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Home = _ref => {\n  _s();\n\n  let {\n    contract\n  } = _ref;\n  const audioRef = useRef(null);\n  const [loading, setLoading] = useState(true);\n  const [isPlaying, setIsPlaying] = useState(null);\n  const [currentItemIndex, setCurrentItemIndex] = useState(0);\n  const [marketItems, setMarketItems] = useState(null);\n\n  const loadMarketplaceItems = async () => {\n    // Get all unsold items/tokens\n    const results = await contract.getAllUnsoldTokens();\n    const marketItems = await Promise.all(results.map(async i => {\n      if (i.tokenId != 3) {\n        // get uri url from contract\n        const uri = await contract.tokenURI(i.tokenId); // use uri to fetch the nft metadata stored on ipfs \n\n        const response = await fetch(uri + \".json\");\n        const metadata = await response.json();\n        console.log(metadata);\n        const identicon = `data:image/png;base64,${new Identicon(metadata.name + metadata.price, 330).toString()}`; // define item object\n\n        let item = {\n          price: i.price,\n          itemId: i.tokenId,\n          name: metadata.name,\n          audio: metadata.audio,\n          identicon\n        };\n        console.log(item);\n        return item;\n      } else {\n        // get uri url from contract\n        const uri = await contract.tokenURI(i.tokenId); // use uri to fetch the nft metadata stored on ipfs \n\n        const response = await fetch(uri + \".json\");\n        const metadata = await response.json();\n        console.log(metadata.name);\n        const identicon = `data:image/png;base64,${new Identicon(metadata.name + 'cold' + metadata.price, 330).toString()}`; // define item object\n\n        let item = {\n          price: i.price,\n          itemId: i.tokenId,\n          name: metadata.name,\n          audio: metadata.audio,\n          identicon\n        };\n        console.log(item);\n        return item;\n      }\n    }));\n    setMarketItems(marketItems);\n    setLoading(false);\n  };\n\n  const buyMarketItem = async item => {\n    await (await contract.buyToken(item.itemId, {\n      value: item.price\n    })).wait();\n    loadMarketplaceItems();\n  };\n\n  const skipSong = forwards => {\n    if (forwards) {\n      setCurrentItemIndex(() => {\n        let index = currentItemIndex;\n        index++;\n\n        if (index > marketItems.length - 1) {\n          index = 0;\n        }\n\n        return index;\n      });\n    } else {\n      setCurrentItemIndex(() => {\n        let index = currentItemIndex;\n        index--;\n\n        if (index < 0) {\n          index = marketItems.length - 1;\n        }\n\n        return index;\n      });\n    }\n  };\n\n  useEffect(() => {\n    if (isPlaying) {\n      audioRef.current.play();\n    } else if (isPlaying !== null) {\n      audioRef.current.pause();\n    }\n  });\n  useEffect(() => {\n    !marketItems && loadMarketplaceItems();\n  });\n  if (loading) return /*#__PURE__*/_jsxDEV(\"main\", {\n    style: {\n      padding: \"1rem 0\"\n    },\n    children: /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container-fluid mt-5\",\n    children: marketItems.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: /*#__PURE__*/_jsxDEV(\"main\", {\n        role: \"main\",\n        className: \"col-lg-12 mx-auto\",\n        style: {\n          maxWidth: '500px'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"content mx-auto\",\n          children: [/*#__PURE__*/_jsxDEV(\"audio\", {\n            src: marketItems[currentItemIndex].audio,\n            ref: audioRef\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Card, {\n            children: [/*#__PURE__*/_jsxDEV(Card.Header, {\n              children: [currentItemIndex + 1, \" of \", marketItems.length]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Card.Img, {\n              variant: \"top\",\n              src: marketItems[currentItemIndex].identicon\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Card.Body, {\n              color: \"secondary\",\n              children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n                as: \"h2\",\n                children: [\" \", marketItems[currentItemIndex].name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 113,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-grid px-4\",\n                children: /*#__PURE__*/_jsxDEV(ButtonGroup, {\n                  size: \"lg\",\n                  \"aria-label\": \"Basic example\",\n                  children: [/*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"secondary\",\n                    onClick: () => skipSong(false),\n                    children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                      xmlns: \"http://www.w3.org/2000/svg\",\n                      width: \"32\",\n                      height: \"32\",\n                      fill: \"currentColor\",\n                      className: \"bi bi-skip-backward\",\n                      viewBox: \"0 0 16 16\",\n                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                        d: \"M.5 3.5A.5.5 0 0 1 1 4v3.248l6.267-3.636c.52-.302 1.233.043 1.233.696v2.94l6.267-3.636c.52-.302 1.233.043 1.233.696v7.384c0 .653-.713.998-1.233.696L8.5 8.752v2.94c0 .653-.713.998-1.233.696L1 8.752V12a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5zm7 1.133L1.696 8 7.5 11.367V4.633zm7.5 0L9.196 8 15 11.367V4.633z\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 118,\n                        columnNumber: 27\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 117,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 116,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"secondary\",\n                    onClick: () => setIsPlaying(!isPlaying),\n                    children: isPlaying ? /*#__PURE__*/_jsxDEV(\"svg\", {\n                      xmlns: \"http://www.w3.org/2000/svg\",\n                      width: \"32\",\n                      height: \"32\",\n                      fill: \"currentColor\",\n                      className: \"bi bi-pause\",\n                      viewBox: \"0 0 16 16\",\n                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                        d: \"M6 3.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5zm4 0a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5z\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 124,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 123,\n                      columnNumber: 27\n                    }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n                      xmlns: \"http://www.w3.org/2000/svg\",\n                      width: \"32\",\n                      height: \"32\",\n                      fill: \"currentColor\",\n                      className: \"bi bi-play\",\n                      viewBox: \"0 0 16 16\",\n                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                        d: \"M10.804 8 5 4.633v6.734L10.804 8zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692z\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 128,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 127,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 121,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"secondary\",\n                    onClick: () => skipSong(true),\n                    children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                      xmlns: \"http://www.w3.org/2000/svg\",\n                      width: \"32\",\n                      height: \"32\",\n                      fill: \"currentColor\",\n                      className: \"bi bi-skip-forward\",\n                      viewBox: \"0 0 16 16\",\n                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                        d: \"M15.5 3.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V8.752l-6.267 3.636c-.52.302-1.233-.043-1.233-.696v-2.94l-6.267 3.636C.713 12.69 0 12.345 0 11.692V4.308c0-.653.713-.998 1.233-.696L7.5 7.248v-2.94c0-.653.713-.998 1.233-.696L15 7.248V4a.5.5 0 0 1 .5-.5zM1 4.633v6.734L6.804 8 1 4.633zm7.5 0v6.734L14.304 8 8.5 4.633z\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 134,\n                        columnNumber: 27\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 133,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 132,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 115,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 114,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 112,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Card.Footer, {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-grid my-1\",\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  onClick: () => buyMarketItem(marketItems[currentItemIndex]),\n                  variant: \"primary\",\n                  size: \"lg\",\n                  children: `Buy for ${ethers.utils.formatEther(marketItems[currentItemIndex].price)} ETH`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 142,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 140,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"main\", {\n      style: {\n        padding: \"1rem 0\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"No listed assets\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 11\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Home, \"tJEck30DZbp4E/jeFRbIbVdXVhM=\");\n\n_c = Home;\nexport default Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["/Users/cengwenxin/Desktop/6883project/src/frontend/components/Home.js"],"names":["useState","useEffect","useRef","ethers","Identicon","Card","Button","ButtonGroup","Home","contract","audioRef","loading","setLoading","isPlaying","setIsPlaying","currentItemIndex","setCurrentItemIndex","marketItems","setMarketItems","loadMarketplaceItems","results","getAllUnsoldTokens","Promise","all","map","i","tokenId","uri","tokenURI","response","fetch","metadata","json","console","log","identicon","name","price","toString","item","itemId","audio","buyMarketItem","buyToken","value","wait","skipSong","forwards","index","length","current","play","pause","padding","maxWidth","utils","formatEther"],"mappings":"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","sourcesContent":["import { useState, useEffect, useRef } from 'react'\nimport { ethers } from \"ethers\"\nimport Identicon from 'identicon.js';\nimport { Card, Button, ButtonGroup } from 'react-bootstrap'\n\nconst Home = ({ contract }) => {\n  const audioRef = useRef(null);\n  const [loading, setLoading] = useState(true)\n  const [isPlaying, setIsPlaying] = useState(null)\n  const [currentItemIndex, setCurrentItemIndex] = useState(0)\n  const [marketItems, setMarketItems] = useState(null)\n  const loadMarketplaceItems = async () => {\n    // Get all unsold items/tokens\n    const results = await contract.getAllUnsoldTokens()\n    const marketItems = await Promise.all(results.map(async i => {\n      if(i.tokenId != 3){\n        // get uri url from contract\n      const uri = await contract.tokenURI(i.tokenId)\n      // use uri to fetch the nft metadata stored on ipfs \n      const response = await fetch(uri + \".json\")\n      const metadata = await response.json()\n      console.log(metadata)\n      const identicon = `data:image/png;base64,${new Identicon(metadata.name + metadata.price, 330).toString()}`\n      // define item object\n      let item = {\n        price: i.price,\n        itemId: i.tokenId,\n        name: metadata.name,\n        audio: metadata.audio,\n        identicon\n      }\n      console.log(item)\n      return item\n      }\n      else{\n        // get uri url from contract\n      const uri = await contract.tokenURI(i.tokenId)\n      // use uri to fetch the nft metadata stored on ipfs \n      const response = await fetch(uri + \".json\")\n      const metadata = await response.json()\n      console.log(metadata.name)\n      const identicon = `data:image/png;base64,${new Identicon(metadata.name + 'cold' + metadata.price, 330).toString()}`\n      // define item object\n      let item = {\n        price: i.price,\n        itemId: i.tokenId,\n        name: metadata.name,\n        audio: metadata.audio,\n        identicon\n      }\n      console.log(item)\n      return item\n      }\n      \n    }))\n    setMarketItems(marketItems)\n    setLoading(false)\n  }\n  const buyMarketItem = async (item) => {\n    await (await contract.buyToken(item.itemId, { value: item.price })).wait()\n    loadMarketplaceItems()\n  }\n  const skipSong = (forwards) => {\n    if (forwards) {\n      setCurrentItemIndex(() => {\n        let index = currentItemIndex\n        index++\n        if (index > marketItems.length - 1) {\n          index = 0;\n        }\n        return index\n      })\n    } else {\n      setCurrentItemIndex(() => {\n        let index = currentItemIndex\n        index--\n        if (index < 0) {\n          index = marketItems.length - 1;\n        }\n        return index\n      })\n    }\n  }\n  useEffect(() => {\n    if (isPlaying) {\n      audioRef.current.play()\n    } else if (isPlaying !== null) {\n      audioRef.current.pause()\n    }\n  })\n  useEffect(() => {\n    !marketItems && loadMarketplaceItems()\n  })\n\n  if (loading) return (\n    <main style={{ padding: \"1rem 0\" }}>\n      <h2>Loading...</h2>\n    </main>\n  )\n  return (\n\n    <div className=\"container-fluid mt-5\">\n\n      {marketItems.length > 0 ?\n        <div className=\"row\">\n          <main role=\"main\" className=\"col-lg-12 mx-auto\" style={{ maxWidth: '500px' }}>\n            <div className=\"content mx-auto\">\n              <audio src={marketItems[currentItemIndex].audio} ref={audioRef}></audio>\n              <Card>\n                <Card.Header>{currentItemIndex + 1} of {marketItems.length}</Card.Header>\n                <Card.Img variant=\"top\" src={marketItems[currentItemIndex].identicon} />\n                <Card.Body color=\"secondary\">\n                  <Card.Title as=\"h2\" > {marketItems[currentItemIndex].name}</Card.Title>\n                  <div className=\"d-grid px-4\">\n                    <ButtonGroup size=\"lg\" aria-label=\"Basic example\">\n                      <Button variant=\"secondary\" onClick={() => skipSong(false)}>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" fill=\"currentColor\" className=\"bi bi-skip-backward\" viewBox=\"0 0 16 16\">\n                          <path d=\"M.5 3.5A.5.5 0 0 1 1 4v3.248l6.267-3.636c.52-.302 1.233.043 1.233.696v2.94l6.267-3.636c.52-.302 1.233.043 1.233.696v7.384c0 .653-.713.998-1.233.696L8.5 8.752v2.94c0 .653-.713.998-1.233.696L1 8.752V12a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5zm7 1.133L1.696 8 7.5 11.367V4.633zm7.5 0L9.196 8 15 11.367V4.633z\" />\n                        </svg>\n                      </Button>\n                      <Button variant=\"secondary\" onClick={() => setIsPlaying(!isPlaying)}>\n                        {isPlaying ? (\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" fill=\"currentColor\" className=\"bi bi-pause\" viewBox=\"0 0 16 16\">\n                            <path d=\"M6 3.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5zm4 0a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5z\" />\n                          </svg>\n                        ) : (\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" fill=\"currentColor\" className=\"bi bi-play\" viewBox=\"0 0 16 16\">\n                            <path d=\"M10.804 8 5 4.633v6.734L10.804 8zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692z\" />\n                          </svg>\n                        )}\n                      </Button>\n                      <Button variant=\"secondary\" onClick={() => skipSong(true)}>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" fill=\"currentColor\" className=\"bi bi-skip-forward\" viewBox=\"0 0 16 16\">\n                          <path d=\"M15.5 3.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V8.752l-6.267 3.636c-.52.302-1.233-.043-1.233-.696v-2.94l-6.267 3.636C.713 12.69 0 12.345 0 11.692V4.308c0-.653.713-.998 1.233-.696L7.5 7.248v-2.94c0-.653.713-.998 1.233-.696L15 7.248V4a.5.5 0 0 1 .5-.5zM1 4.633v6.734L6.804 8 1 4.633zm7.5 0v6.734L14.304 8 8.5 4.633z\" />\n                        </svg>\n                      </Button>\n                    </ButtonGroup>\n                  </div>\n                </Card.Body>\n                <Card.Footer>\n                  <div className='d-grid my-1'>\n                    <Button onClick={() => buyMarketItem(marketItems[currentItemIndex])} variant=\"primary\" size=\"lg\">\n                      {`Buy for ${ethers.utils.formatEther(marketItems[currentItemIndex].price)} ETH`}\n                    </Button>\n                  </div>\n                </Card.Footer>\n              </Card>\n            </div>\n          </main >\n        </div >\n        : (\n          <main style={{ padding: \"1rem 0\" }}>\n            <h2>No listed assets</h2>\n          </main>\n        )}\n\n    </div >\n  );\n}\nexport default Home\n"]},"metadata":{},"sourceType":"module"}